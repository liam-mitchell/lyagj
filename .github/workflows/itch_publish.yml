name: Deploy

on: push
env:
    ITCH_USERNAME: chowieuk
    ITCH_GAME_ID: lyagj
jobs:
    deploy:
        runs-on: ubuntu-latest
        name: Deploy to Itch.io
        strategy:
            fail-fast: true
        steps:
            - name: Check out repository
              uses: actions/checkout@v4
            - name: Archive build
              run: git archive --format=zip --output ./build.zip master
            - name: Upload to Itch
              uses: manleydev/butler-publish-itchio-action@master
              env:
                  BUTLER_CREDENTIALS: ${{ secrets.ITCHIO_API_KEY }}
                  CHANNEL: HTML
                  ITCH_GAME: lyagj
                  ITCH_USER: chowieuk
                  PACKAGE: ./build.zip
            - name: Check status
              run: butler status chowieuk/lyagj:HTML
